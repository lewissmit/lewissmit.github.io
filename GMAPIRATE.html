<html>

  <head>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  </head>

  <!-- Plots go in blank <div> elements. 
    You can size them in the plot layout,
    or give the div a size as shown here.
-->

  <body>

    <div id="myDiv" style="width:90%;height:100%;"></div>
    <script>
   Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000003&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData1) {
    Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000003&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData2) {
    Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000001&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData3) {
     Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000001&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData4) {
     Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000002&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData5) {
     Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000002&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData6) {
     Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000004&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData7) {
     Plotly.d3.csv("https://api.coronavirus.data.gov.uk/v2/data?areaType=utla&areaCode=E08000004&metric=cumFirstEpisodesBySpecimenDateRate&metric=cumReinfectionsBySpecimenDateRate&format=csv", function(err, csvData8) {
              
                          var x1 = [],
                            y1 = [];

                          for (var i = 0; i < csvData1.length; i++) {
                            row1 = csvData1[i];
                            x1.push(row1['date']);
                            y1.push(row1['cumFirstEpisodesBySpecimenDateRate']);
                          }

                          var trace1 = {
                            x: x1,
                            y: y1,
                            name: 'Manchester - first episodes',
                            mode: 'lines',
                            line: {
                              color: 'rgb(255, 25, 0)',
                              size: 2
                            }
                          };

                          /* Second URL data */
                          var x2 = [],
                            y2 = [];

                          for (var i = 0; i < csvData2.length; i++) {
                            row1 = csvData2[i];
                            x2.push(row1['date']);
                            y2.push(row1['cumReinfectionsBySpecimenDateRate']);
                          }

                          var trace2 = {
                            x: x2,
                            y: y2,
                            name: 'Manchester - reinfections',
                            mode: 'lines',
                            line: {
                              color: 'rgb(255, 25, 0)',
                              dash: 'dot',
                              size: 2
                            }
                          };
                          var x3 = [],
                            y3 = [];

                          for (var i = 0; i < csvData3.length; i++) {
                            row1 = csvData3[i];
                            x3.push(row1['date']);
                            y3.push(row1['cumFirstEpisodesBySpecimenDateRate']);
                          }
                          var trace3 = {
                            x: x3,
                            y: y3,
                            name: 'Bolton -first episodes',
                            mode: 'lines',
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(110, 43, 19)',
                              size: 2
                            }
                          };
                          /* Second URL data */
                          var x4 = [],
                            y4 = [];

                          for (var i = 0; i < csvData4.length; i++) {
                            row1 = csvData4[i];
                            x4.push(row1['date']);
                            y4.push(row1['cumReinfectionsBySpecimenDateRate']);
                          }

                          var trace4 = {
                            x: x4,
                            y: y4,
                            name: 'Bolton - reinfections',
                            mode: 'lines',
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(110, 43, 19)',
                              dash: 'dot',
                              size: 2
                            }
                          };
 var x5 = [],
                    y5 = [];

                          for (var i = 0; i < csvData5.length; i++) {
                            row1 = csvData5[i];
                            x5.push(row1['date']);
                            y5.push(row1['cumFirstEpisodesBySpecimenDateRate']);
                          }
                          var trace5 = {
                            x: x5,
                            y: y5,
                            name: 'Bury - first episodes',
                            mode: 'lines',
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(35, 110, 19)',
                              size: 2
                            }
                          };
                          var x6 = [],
                    y6 = [];

                          for (var i = 0; i < csvData6.length; i++) {
                            row1 = csvData5[i];
                            x6.push(row1['date']);
                            y6.push(row1['cumReinfectionsBySpecimenDateRate']);
                          }
                          var trace6 = {
                            x: x6,
                            y: y6,
                            name: 'Bury - reinfections',
                            mode: 'lines',
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(35, 110, 19)',
                              size: 2,
                              dash: 'dot'
                            }
                          };
                           var x7 = [],
                    y7 = [];

                          for (var i = 0; i < csvData7.length; i++) {
                            row1 = csvData5[i];
                            x7.push(row1['date']);
                            y7.push(row1['cumFirstEpisodesBySpecimenDateRate']);
                          }
                          var trace7 = {
                            x: x7,
                            y: y7,
                            name: 'Oldham - first episodes',
                            mode: 'lines',
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(108, 19, 110)',
                              size: 2
                            }
                          };
 var x8 = [],
                    y8 = [];

                          for (var i = 0; i < csvData8.length; i++) {
                            row1 = csvData8[i];
                            x8.push(row1['date']);
                            y8.push(row1['cumReinfectionsBySpecimenDateRate']);
                          }
                          var trace8 = {
                            x: x8,
                            y: y8,
                            name: 'Oldham - reinfections',
                            mode: 'lines',
                           
                            visible: 'legendonly',
                            line: {
                              color: 'rgb(108, 19, 110)',
                              size: 2,
                              dash: 'dot'
                            }
                          };
                          data = [trace1, trace2, trace3, trace4,trace5,trace6,trace7,trace8];

                          layout = {
                            paper_bgcolor: 'rgb(255, 255, 255)',
                            plot_bgcolor: 'rgb(255, 255, 255)',
                            autosize: false,
                            width: 900,
                            height: 500,
                            margin: {
                              l: 70,
                              r: 20,
                              b: 120,
                              t: 40,
                              pad: 4
                            },
                            showlegend: true,
                            legend: {
                              x: 1.00,
                              y: 1
                            },
                            xaxis: {
                              range: ['2021-01-01', '2022-04-30'],
                              title: '',
                              tickangle: 320
                            },
                            yaxis: {
                              range: [0, 50000],
                              title: 'Rate per 100,000 population',
                              type: 'lines'
                            },
                            annotations: [{
                                x: '2020-03-09',
                                y: 10000,
                                xref: 'x',
                                yref: 'y',
                                text: '2020',
                                font: {
                                  size: 14,
                                  color: '#bb99df'
                                },
                                showarrow: false,

                              },
                              {
                                x: '2021-01-11',
                                y: 10000,
                                xref: 'x',
                                yref: 'y',
                                text: '2021',
                                font: {
                                  size: 14,
                                  color: '#bb99df'
                                },
                                showarrow: false,

                              }
                            ],

                            hovermode: "x",
                            hoverlabel: {
                              namelength: -1,
                              bgcolor: "#FFF"
                            },
                            config: {
                              responsive: true
                            }

                          };

                          Plotly.newPlot('myDiv', data, layout);
                        });
                      });
                    });
                  });
                  });
                  });
                  });
                  });

    </script>
  </body>

</html>

