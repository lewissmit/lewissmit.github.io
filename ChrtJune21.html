<html>
<head>
  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<!-- Plots go in blank <div> elements. 
    You can size them in the plot layout,
    or give the div a size as shown here.
-->
<body>

<div id="myDiv" style="width:90%;height:100%;"></div>
<script>
Plotly.d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vSo9t3Qs08lbS1D0bV-oGypVi1lavoATakQ_ApMBuHshPrXS53bnwrNk9XqXiORhlhyrtNpoou7reJl/pub?gid=0&single=true&output=csv", function(err, rows){
      function unpack(rows, key) {
          return rows.map(function(row) { return row[key]; });
      }

trace1 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value1'),
  mode: 'bar',
  line: {color: 'rgb(68, 68, 68)',
  width: 1},
  marker: {
    color: 'rgb(0, 102, 102)',
    size: 8
  },
  name: 'Domestic noise',
  type: 'bar',
  
};
trace2 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value2'),
  mode: 'bar',
  line: {color: 'rgb(252, 186, 3)',
  width: 1},
  marker: {
    color: 'rgb(252, 186, 3)',
    size: 8
  },
  name: 'Drainage',
  type: 'bar',
  
};
trace3 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value3'),
  mode: 'bar',
  line: {color: 'rgb(24, 135, 95)',
  width: 1},
  marker: {
    color: 'rgb(5, 55, 105)',
    size: 8
  },
  name: 'Fly tipping',
  type: 'bar',
  
};
trace4 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value4'),
  mode: 'bar',
  line: {color: 'rgb(24, 135, 95)',
  width: 1},
  marker: {
    color: 'rgb(7, 7, 205)',
    size: 8
  },
  name: 'Highways defects',
  type: 'bar',
  
};
trace5 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value5'),
  mode: 'bar',
  line: {color: 'rgb(62, 205, 15)',
  width: 1},
  marker: {
    color: 'rgb(61, 205, 15)',
    size: 8
  },
  name: 'Street cleansing',
  type: 'bar',
  
};
trace6 = {
  x: unpack(rows, 'Date'),
  y: unpack(rows, 'Value6'),
  mode: 'bar',
  line: {color: 'rgb(12, 5, 5)',
  width: 1},
  marker: {
    color: 'rgb(12, 5, 5)',
    size: 8
  },
  name: 'Untidy gardens',
  type: 'bar',
  
};
data = [trace1,trace2,trace3,trace4,trace5,trace6];

layout = {
  paper_bgcolor: 'rgb(256, 256, 256)',
  plot_bgcolor: 'rgb(256, 256, 256)',
  autosize: false,
  width: 850,
  height: 350,
  barmode: 'stack',
  margin: {
    l: 70,
    r: 80,
    b: 80,
    t: 40,
    pad: 4
  },
  title: '',
  xaxis: {
    title: '',
    tickangle:320
  },
  yaxis: {
    range: [0, 10],
    title: 'Number of CRM reports'
    },
  
};

Plotly.newPlot('myDiv', data, layout);

});

</script>
</body>
</html>
