<html>

  <head>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  </head>

  <!-- Plots go in blank <div> elements. 
    You can size them in the plot layout,
    or give the div a size as shown here.
-->

  <body>

    <div id="myDiv" style="width:90%;height:100%;"></div>
    <script>
      Plotly.d3.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vRhFpDrtHLT3U3msRhirTrMZhsCza2J3LAPBVsIu-53vZKuimUminSFbwoaekhJDQquraAuJoz17wWf/pub?gid=322169538&single=true&output=csv", function(err, rows) {
        function unpack(rows, key) {
          return rows.map(function(row) {
            return row[key];
          });
        }

        trace1 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value8'),
          marker: {
            color: '#8b4513'
          },
          name: 'Chorlton',
          stackgroup: 'one'

        };

        trace2 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value30'),
          marker: {
            color: '#006400'
          },
          name: 'Whalley Range',
          stackgroup: 'one'

        };

        trace3 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value15'),
          marker: {
            color: '#00008b'
          },
          name: 'Fallowfield',
          stackgroup: 'one'
        };
        trace4 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value20'),
          marker: {
            color: '#ff0000'
          },
          name: 'Levenshulme',
          stackgroup: 'one'
        };
        trace5 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value21'),
          marker: {
            color: '#ffff00'
          },
          name: 'Longsight',
          stackgroup: 'one'
        };
        trace6 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value28'),
          marker: {
            color: '#00ff7f'
          },
          name: 'Rusholme',
          stackgroup: 'one'

        };
        trace7 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value23'),
          marker: {
            color: '#00ffff'
          },
          name: 'Moss Side',
          stackgroup: 'one'

        };
        trace8 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value19'),
          marker: {
            color: '#ff00ff'
          },
          name: 'Hulme',

          stackgroup: 'one'

        };
        trace9 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value2'),
          marker: {
            color: '#6495ed'
          },
          name: 'Ardwick',
          stackgroup: 'one'

        };
        trace10 = {
          x: unpack(rows, 'Date'),
          y: unpack(rows, 'Value16'),
          marker: {
            color: '#ff69b4'
          },
          name: 'Gorton & Abbey Hey',
          stackgroup: 'one'

        };
        
        data = [trace1, trace2, trace3, trace4, trace5, trace6, trace7, trace8, trace9, trace10];

        layout = {
          paper_bgcolor: 'rgb(255, 255, 255)',
          plot_bgcolor: 'rgb(255, 255, 255)',
          showlegend: true,
          legend: {
            'orientation': 'h',
            y: 1.1
          },

          autosize: false,
          width: 900,
          height: 350,
          margin: {
            l: 80,
            r: 50,
            b: 80,
            t: 40,
            pad: 4
          },
          barmode: 'stack',
          xaxis: {
            title: '',
            tickangle: 320
          },
          yaxis: {
            range: [0, 1500],
            title: 'Number of completed jobs',
            type: 'bar'
          },

          hovermode: "x",
          hoverlabel: {
            namelength: -1,
            bgcolor: "#FFF"
          },
          config: {
            responsive: true
          }
        };

        Plotly.newPlot('myDiv', data, layout);

      });

    </script>
  </body>

</html>
